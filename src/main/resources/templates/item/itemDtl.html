<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.w3.org/1999/xhtml" layout:decorate="~{layouts/layout1}">

<head>
    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    <script src="https://code.jquery.com/jquery-3.6.3.min.js"
            integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
</head>

<th:block layout:fragment="script">
    <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script th:inline="javascript">
        $(document).ready(function () {
            calculateTotalPrice();

            $("#count").change(function () {
                calculateTotalPrice();
            });
        });

        function calculateTotalPrice() {
            var count = $("#count").val();
            var price = $("#price").val();
            var totalPrice = price * count;
            $("#totalPrice").html(totalPrice + 'ì›');
        }

        function order() {
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");

            var url = "/order";
            var paramData = {
                itemId: $("#itemId").val(),
                count: $("#count").val()
            }

            var param = JSON.stringify(paramData);

            $.ajax({
                url: url,
                type: "POST",
                data: param,
                contentType: "application/json",
                beforeSend: function (xhr) {
                    /*ë°ì´í„° ì „ì†¡í•˜ê¸° ì „ì— í—¤ë”ì´ csrf ê°’ì„ ì„¤ì •*/
                    xhr.setRequestHeader(header, token);
                },
                dataType: "json",
                cache: false,
                success: function (result, status) {
                    console.log(result)
                    alert("ê²°ì œë¥¼ ì§„í–‰.");
                    location.href = '/payment/' + result;

                },
                error: function (jqXHR, status, error) {
                    if (jqXHR.status == '401') {
                        alert('ë¡œê·¸ì¸ í›„ ì´ìš©í•´ì£¼ì„¸ìš”.');
                        location.href = '/members/login';
                    } else {
                        alert(jqXHR.responseText);
                    }
                }
            });
        }

        function addCart() {
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");

            var url = "/cart";

            var paramData = {
                itemId: $("#itemId").val(),
                count: $("#count").val()
            };
            var param = JSON.stringify(paramData);

            $.ajax({
                url: url,
                type: "POST",
                contentType: "application/json",
                data: param,
                beforeSend: function (xhr) {
                    /*ë°ì´í„° ì „ì†¡í•˜ê¸° ì „ì— í—¤ë”ì´ csrf ê°’ì„ ì„¤ì •*/
                    xhr.setRequestHeader(header, token);
                },
                dataType: "json",
                cache: false,
                success: function (result, status) {
                    alert("ë§¤ì¹˜ë¥¼ ì°œ ëª©ë¡ì— ë‹´ì•˜ìŠµë‹ˆë‹¤.");
                    location.href = '/';
                },
                error: function (jqXHR, status, error) {
                    if (jqXHR.status == '401') {
                        alert('ë¡œê·¸ì¸ í›„ ì´ìš©í•´ì£¼ì„¸ìš”.');
                        location.href = '/members/login';
                    } else {
                        alert(jqXHR.responseText);
                    }
                }
            });
        }
    </script>
</th:block>
<!-- ì‚¬ìš©ì CSS ì¶”ê°€ -->
<th:block layout:fragment="css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f7f8fa;
            margin: 0;
            padding: 0;
        }

        .container {
            justify-content: center;
            padding: 20px;
            max-width: 1024px;
        }

        .image-container {
            width: 100%;
            height: 500px;
            overflow: hidden;
            border-radius: 8px;
        }

        .image-container img {
             width: 100%;
    height: 100%;
    object-fit: cover;
        }

        .left-container {
            width: 160px;
        }

        span {
            margin-bottom: 10px;
        }

        .custom-btn {
            width: 70px;
            /* ë²„íŠ¼ì˜ ë„ˆë¹„ */
            height: 50px;
            /* ë²„íŠ¼ì˜ ë†’ì´ */
            padding: 5px;
            /* ë²„íŠ¼ ì•ˆì˜ ì—¬ë°± */
        }

        .custom-btn img {
            max-width: 100%;
            /* ì´ë¯¸ì§€ì˜ ìµœëŒ€ ë„ˆë¹„ë¥¼ ë²„íŠ¼ì— ë§ì¶¤ */
            max-height: 100%;
            /* ì´ë¯¸ì§€ì˜ ìµœëŒ€ ë†’ì´ë¥¼ ë²„íŠ¼ì— ë§ì¶¤ */
        }

        .match-info,
        .match-details {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin: 10px;
            min-width: 480px;
        }

        .match-point {
            flex: 2;
        }

        .match-details {
            flex: 1;
            max-width: 300px;
            height: fit-content;
            position: sticky;
            top: 3px;
            right: 0;
            background-color: white;
            z-index: 1000;
            padding: 15px;
            overflow: auto;
        }


        .match-info h3,
        .match-details h4 {
            font-size: 23px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .match-details h3 {
            margin-top: 0;
        }

        .match-details p {
            font-size: 14px;
            margin: 5px 0;
        }

        .match-details .price {
            font-size: 18px;
            font-weight: bold;
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .match-details .btn {
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
        }

        .match-details .note {
            color: #888;
            font-size: 12px;
            margin-top: 10px;
        }

        .match-details a {
            color: #007bff;
            text-decoration: none;
            margin-left: 5px;
        }

        .match-details a:hover {
            text-decoration: underline;
        }

        .level,
        .gender,
        .format,
        .participants,
        .extra-info {
            margin-bottom: 20px;
        }

        .text-left {
            font-size: 26px;
            font-weight: bold;
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .match-details h3 {
            margin-top: 0;
            font-size: 26px;
            font-weight: bold;
        }

        .stadium-container {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin-bottom: 20px;
            margin-left: 10px;
            min-width: 480px;
        }

        .stadium-container h4 {
            font-size: 30px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        /*ëŒ“ê¸€ css*/

        .last {
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            margin-left: 10px;
        }

        /* ì œëª© ìŠ¤íƒ€ì¼ */
        .last h1 {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
        }

        /* ëŒ“ê¸€ ì‘ì„± ì„¹ì…˜ */
        .last .comment-section {
            margin-bottom: 30px;
            padding: 15px;
            background-color: #fff;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .comment-write {
            display: flex;
            align-items: flex-start;
        }

        .comment-write p {
            font-size: 16px;
            font-weight: bold;
            margin-right: 10px;
            color: #555;
        }

        .comment-write textarea {
            flex-grow: 1;
            height: 100px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 14px;
            resize: vertical;
            margin-right: 10px;
        }

        #comment-write-btn {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #comment-write-btn:hover {
            background-color: #0056b3;
        }

        /* ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ */
        #comment-list table {
            width: 100%;
            border-collapse: collapse;
        }

        #comment-list th,
        #comment-list td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        #comment-list th {
            background-color: #f0f0f0;
            font-weight: bold;
            color: #333;
        }

        .fixed-writer,
        .fixed-contents,
        .fixed-dateWidth {
            font-size: 14px;
            color: #555;
        }

        .comment-delete {
            text-align: right;
        }

        .btn-comment-delete {
            background-color: #dc3545;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-comment-delete:hover {
            background-color: #c82333;
        }

        .arrow-container {
            max-width: 480px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-left: 10px;
            margin-bottom: 20px;
        }

        .arrow-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .arrow-title h2 {
            margin: 0;
        }

        .arrow {
            font-size: 24px;
            transform: rotate(0deg);
            transition: transform 0.3s ease;
        }

        .arrow1.rotate {
            transform: rotate(90deg);
        }

        .arrow2.rotate {
            transform: rotate(90deg);
        }

        .arrow-content {
            overflow: hidden;
            height: 0;
            transition: height 0.3s ease;
            padding-top: 5px;
        }

        .arrow-content h3 {
            font-weight: 600;
        }
    </style>
</th:block>
<body>
<div layout:fragment="content" class="container">
    <input type="hidden" id="itemId" th:value="${item.id}">
    <!--ìŠ¬ë¼ì´ë“œ---->
    <div class="image-container">
        <img th:src="${item.itemImgDtoList[0].imgUrl}" class="rounded repImg" th:alt="${item.itemNm}">
    </div>
    <div class="Big-container">
        <div class="main-container" style="display:flex;">
            <div class="MatchPoint">
                <div class="match-info">
                    <h3>ë§¤ì¹˜ í¬ì¸íŠ¸</h3>
                    <div class="center-container" style="display:flex;">
                        <div class="left-container" style="margin-right: 90px;">
                            <div class="a" style="display:flex;">
                                <span>ğŸ”¹</span>
                                <div class="level" th:text="${item.level}"></div>
                            </div>
                            <div class="b" style="display:flex;">
                                <span>ğŸ‘«</span>
                                <div class="gender" th:text="${item.gender}"></div>
                            </div>
                            <div class="c" style="display:flex;">
                                <span>ğŸ“…</span>
                                <div class="format" th:text="${item.matchInfo}"></div>
                            </div>
                        </div>
                        <div class="right-container">
                            <div class="d" style="display:flex;">
                                <span>ğŸ‘¥</span>
                                <div class="participants" th:text="${item.memberNumber}"></div>
                            </div>
                            <div class="e" style="display:flex;">
                                <span>âš½</span>
                                <div class="extra-info" th:text="${item.shoes}"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--êµ¬ì¥ ì •ë³´-->
                <div class="mgt-30" style="max-width: 480px;">
                    <div class="stadium-container">
                        <h4 class=" border-success-subtle rounded-pill display-5" style="margin-top: 17px; margin-left: 10px;">
                            êµ¬ì¥ ì •ë³´
                        </h4>
                        <hr class="my-4" style="margin-top: 0.2rem !important">
                        <p class="lead" th:text="${item.itemDetail}" style="white-space:pre-line; font-size:1rem;"></p>
                    </div>
                </div>
                <!--ì¶”ê°€ ì‚¬ì§„-->
                <div th:each="itemImg, iterStat : ${item.itemImgDtoList}" class="text-center">
                    <img th:if="${not #strings.isEmpty(itemImg.imgUrl)} and ${iterStat.index != 0}"
                         th:src="${itemImg.imgUrl}" class="rounded mgb-15" width="800">
                </div>
                <!--í´ë¦­ì´ë²¤íŠ¸-->
                <div class="arrow-container">
                    <div class="arrow-title">
                        <h2>ë§¤ì¹˜ ì§„í–‰ ë°©ì‹</h2>
                        <div class="arrow1" onclick="toggleContent1()">&#9002;</div>
                    </div>
                    <div class="arrow-content" id="arrow-content1">
                        <h3>ë§¤ì¹˜ ê·œì¹™</h3>
                        <ul>
                            <li>ëª¨ë“  íŒŒìš¸ì€ ì‚¬ì´ë“œë¼ì¸ì—ì„œ í‚¥ì¸</li>
                            <li>ê³¨í‚¤í¼ì—ê²Œ ë°±íŒ¨ìŠ¤ ê°€ëŠ¥í•œ ì†ìœ¼ë¡œ ì¡ìœ¼ë©´ ì•ˆ ë¼ìš”</li>
                            <li>ì‚¬ëŒì„ í–¥í•œ íƒœí´ ê¸ˆì§€</li>
                        </ul>
                        <h3>ì§„í–‰ ë°©ì‹</h3>
                        <ul>
                            <li>í’‹ì‚´í™”ì™€ ê°œì¸ ìŒë£Œë§Œ ì¤€ë¹„í•˜ì„¸ìš”</li>
                            <li>ë§¤ë‹ˆì €ê°€ ê²½ê¸° ì§„í–‰ì„ ë„ì™€ë“œë ¤ìš”</li>
                            <li>ê³¨í‚¤í¼ì™€ íœ´ì‹ì„ ê³µí‰í•˜ê²Œ ëŒì•„ê°€ë©´ì„œ í•´ìš”</li>
                            <li>ë ˆë²¨ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ íŒ€ì„ ë‚˜ëˆ ìš”</li>
                            <li>ì¹œêµ¬ë¼ë¦¬ ì™€ë„ íŒ€ ì‹¤ë ¥ì´ ë§ì§€ ì•Šìœ¼ë©´ ë‹¤ë¥¸ íŒ€ì´ ë  ìˆ˜ ìˆì–´ìš”</li>
                        </ul>
                        <h3>ì•Œì•„ë‘ë©´ ì¢‹ì•„ìš”</h3>
                        <ul>
                            <li>ì„œë¡œ ì¡´ì¤‘í•˜ê³  ê²©ë ¤í•˜ë©° í•¨ê»˜ ì¦ê²¨ìš”</li>
                            <li>í”Œë© í‰ê·  ë ˆë²¨ì€ ì•„ë§ˆì¶”ì–´2ì—ìš”</li>
                            <li>í”Œë©ì—ì„œëŠ” í•˜ë£¨ í‰ê·  250ë§¤ì¹˜ê°€ ì§„í–‰ë˜ê³  ìˆì–´ìš”</li>
                            <li>ë§¤ì¼ 4,500ì—¬ ëª…ì´ íŒ€ ì—†ì´ë„ í’‹ì‚´ì„ ì¦ê¸°ê³  ìˆì–´ìš”</li>
                        </ul>
                    </div>
                </div>
                <div class="arrow-container">
                    <div class="arrow-title">
                        <h2>í™˜ë¶ˆ ì •ì±…</h2>
                        <div class="arrow2" onclick="toggleContent2()">&#9002;</div>
                    </div>
                    <div class="arrow-content" id="arrow-content2">
                        <h3>ê·¸ ì™¸ ì·¨ì†Œ ê¸°ì¤€</h3>
                        <ul>
                            <li>ê²°ì œ í›„ 30ë¶„ ì´ë‚´ì—ëŠ” í•˜ë£¨ 1íšŒì— í•œí•´ ë¬´ë£Œ ì·¨ì†Œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. (ë‹¨, ë§¤ì¹˜ ì‹œì‘ 90ë¶„ ì´ë‚´ì¼ ê²½ìš° ë¶ˆê°€)</li>
                            <li>ì¿ í° ì‹ ì²­ìëŠ” ë§¤ì¹˜ ì‹œì‘ 90ë¶„ ì „ê¹Œì§€ ì·¨ì†Œ ì‹œ ì¿ í°ì´ ë°˜í™˜ë©ë‹ˆë‹¤.</li>
                            <li>ê²°ì œ ì‹œ ì‹¤ ê²°ì œê¸ˆì•¡(ì¿ í° ì œì™¸)ì„ ê¸°ì¤€ìœ¼ë¡œ ìœ„ ê·œì •ì— ë”°ë¼ í™˜ê¸‰ë©ë‹ˆë‹¤.</li>
                            <li>í˜„ì¥ì—ì„œ ë§¤ì¹˜ê°€ ì·¨ì†Œë˜ëŠ” ê²½ìš° ì°¸ê°€ë¹„ëŠ” ì§„í–‰ë˜ì§€ ì•Šì€ ì‹œê°„ë§Œí¼ ë‹¤ìŒë‚  ì˜¤ì „ í™˜ê¸‰ë©ë‹ˆë‹¤.</li>
                            <li>ë§¤ì¹˜ ì‹œì‘ 90ë¶„ ì „ê¹Œì§€ ìµœì†Œ ì¸ì›ì´ ëª¨ì´ì§€ ì•Šì„ ì‹œ ì¹´ì¹´ì˜¤í†¡ í˜¹ì€ LMSìœ¼ë¡œ ì•ˆë‚´ë˜ë©°, ìë™ ì „ì•¡ í™˜ë¶ˆë©ë‹ˆë‹¤. (ë‹¨, ê³µì§€ ì „ ì§ì ‘ ì·¨ì†Œí•˜ì‹œëŠ” ê²½ìš° ìƒë‹¨
                                ì¼ë°˜ í™˜ë¶ˆ ê·œì •ëŒ€ë¡œ ì²˜ë¦¬ë˜ë‹ˆ ìœ ì˜í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤)</li>
                        </ul>
                        <h3>ë‹¤ìŒì˜ ê²½ìš°ëŠ” í™˜ë¶ˆì´ ë¶ˆê°€í•©ë‹ˆë‹¤.</h3>
                        <ul>
                            <li>êµ¬ì¥, ë‚ ì§œ, ì‹œê°„ ë“±ì„ ì‹¤ìˆ˜ë¡œ ì˜ëª» ì„ íƒí•œ ê²½ìš°</li>
                            <li>ë¶€ìƒ, ì·¨ì—… ë“± ê°œì¸ ì‚¬ì •ìœ¼ë¡œ ì‹ ì²­ëœ ë§¤ì¹˜ì— ì°¸ì—¬í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°</li>
                            <li>ë‹¨ì²´ í˜¹ì€ ì§€ì¸ê³¼ì˜ ì°¸ê°€ë¡œ ë§¤ì¹˜ ì·¨ì†Œ í˜¹ì€ ë³€ê²½ì„ ì›í•˜ëŠ” ê²½ìš°</li>
                            <li>í™©ì‚¬/ë¯¸ì„¸ë¨¼ì§€ë¡œ ì¸í•´ ì·¨ì†Œ í˜¹ì€ ë³€ê²½ì„ ìš”ì²­í•˜ëŠ” ê²½ìš°</li>
                            <li>ë‹¨ìˆœ ë³€ì‹¬ìœ¼ë¡œ ì·¨ì†Œ í˜¹ì€ ë³€ê²½ì„ ìš”ì²­í•˜ëŠ” ê²½ìš°</li>
                        </ul>
                        <h3>ìœ ì˜ì‚¬í•­</h3>
                        <ul>
                            <li>ë¬´ë‹¨ ë¶ˆì°¸í•˜ê±°ë‚˜ ë§¤ì¹˜ ì‹œì‘ 90ë¶„ ì´ë‚´ì— ì·¨ì†Œí•˜ë©´ íŒ¨ë„í‹°ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                (ì°¸ì—¬ê°€ ì–´ë ¤ìš¸ ê²½ìš°, í™˜ë¶ˆì´ ë¶ˆê°€ëŠ¥í•˜ë”ë¼ë„ ì›í™œí•œ ë§¤ì¹˜ ì§„í–‰ì„ ìœ„í•´ ë‚˜ì˜ í”Œë©ì—ì„œ ë¯¸ë¦¬ ì·¨ì†Œí•´ ì£¼ì„¸ìš”.)</li>
                        </ul>
                        <h3>ìš°ì²œ ë° í­ì„¤ ì •ì±…</h3>
                        <ul>
                            <li>ê¸°ìƒì²­ ë‚ ì”¨ëˆ„ë¦¬ ì˜ˆë³´ì— ë”°ë¼ ì§„í–‰ ì—¬ë¶€ ë° í™˜ë¶ˆ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ê³µì§€í•´ë“œë¦½ë‹ˆë‹¤.
                                <ul>
                                    <li>ì˜¤ì „(12ì‹œ ì´ì „) ë§¤ì¹˜ : í•˜ë£¨ ì „ 22ì‹œ ê¸°ì¤€, ë§¤ì¹˜ ì§„í–‰ ì‹œê°„ì˜ ê°•ìˆ˜ëŸ‰ ì˜ˆë³´ê°€ 1mm ì´ìƒ ì‹œ</li>
                                    <li>ì˜¤í›„(12ì‹œ ì´í›„) ë§¤ì¹˜ : ë§¤ì¹˜ ì‹œì‘ 4ì‹œê°„ ì „ ê¸°ì¤€, ë§¤ì¹˜ ì§„í–‰ ì‹œê°„ì˜ ê°•ìˆ˜ëŸ‰ ì˜ˆë³´ê°€ 1mm ì´ìƒ ì‹œ</li>
                                </ul>
                            </li>
                            <li>â€˜ê°•ìˆ˜ ì•ˆë‚´ ì•Œë¦¼í†¡â€™ì„ ë°›ê³ , ë§¤ì¹˜ ì‹œì‘ 90ë¶„ ì „ê¹Œì§€ ì·¨ì†Œí•˜ë©´ ì „ì•¡ í™˜ë¶ˆë©ë‹ˆë‹¤.</li>
                            <li>ê°‘ì‘ìŠ¤ëŸ¬ìš´ ê¸°ìƒ ì•…í™”ë¡œ 1mm ì´ìƒ ê°•ìˆ˜ ì˜ˆë³´ê°€ ë°œìƒí•˜ì˜€ìœ¼ë‚˜ ë§¤ì¹˜ 3ì‹œê°„ ì „ê¹Œì§€ ì•Œë¦¼í†¡ì´ ë°œì†¡ë˜ì§€ ëª»í•œ ê²½ìš°, ì•„ë˜ì™€ ê°™ì´ ì²˜ë¦¬ë©ë‹ˆë‹¤.
                                <ul>
                                    <li>ë§¤ì¹˜ ì‹œì‘ 1ì‹œê°„ 30ë¶„ ~ 3ì‹œê°„ ì „ê¹Œì§€ í™ˆí˜ì´ì§€ ìš°ì¸¡ í•˜ë‹¨ ì±„ë„í†¡ìœ¼ë¡œ ë¬¸ì˜ ì‹œ í™•ì¸ í›„ ê°•ìˆ˜ ì•ˆë‚´ ì•Œë¦¼í†¡ ë°œì†¡ ë˜ëŠ” ì „ì•¡ í™˜ë¶ˆ ì²˜ë¦¬</li>
                                    <li>ë§¤ì¹˜ ì‹œì‘ê¹Œì§€ 1ì‹œê°„ 30ë¶„ ë¯¸ë§Œ ë‚¨ì€ ê²½ìš° ë§¤ì¹˜ í™•ì • í›„ í˜„ì¥ìœ¼ë¡œ ì¶œë°œí•œ ì°¸ê°€ìê°€ ìˆì„ ìˆ˜ ìˆì–´ í˜„ì¥ ë°©ë¬¸ í›„ ë§¤ë‹ˆì €ì—ê²Œ ì·¨ì†Œ ì˜ì‚¬ ì „ë‹¬ ì‹œ
                                        ì „ì•¡ í™˜ë¶ˆ ì²˜ë¦¬ ê°€ëŠ¥(ìµì¼ ì˜¤ì „ ì¼ê´„ í™˜ê¸‰)</li>
                                </ul>
                            </li>
                            <li>ì•Œë¦¼í†¡ ë°œì†¡ ì—†ì´ ì§ì ‘ ì·¨ì†Œí•˜ì‹œëŠ” ê²½ìš° ìƒë‹¨ì˜ ì¼ë°˜ í™˜ë¶ˆ ê·œì •ëŒ€ë¡œ ì²˜ë¦¬ë˜ë‹ˆ ìœ ì˜í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.</li>
                            <li>ë³„ë„ ê³µì§€ê°€ ì—†ì„ ì‹œ ë§¤ì¹˜ëŠ” ì •ìƒ ì§„í–‰ë©ë‹ˆë‹¤.</li>
                            <li>ë‹¤ìˆ˜ì˜ ì¸ì›ì´ ì·¨ì†Œí•˜ê±°ë‚˜, êµ¬ì¥ ìƒíƒœê°€ ì¢‹ì§€ ì•Šì•„ ì§„í–‰ì´ ì–´ë µë‹¤ë©´ ë§¤ì¹˜ ì‹œì‘ 90ë¶„ ì´ë‚´ë¼ë„ ë§¤ì¹˜ë¥¼ ì·¨ì†Œí•©ë‹ˆë‹¤.</li>
                            <li>í˜„ì¥ì—ì„œ ë§¤ì¹˜ê°€ ì·¨ì†Œë˜ê±°ë‚˜ ì¤‘ë‹¨ë˜ë©´ ì§„í–‰í•˜ì§€ ëª»í•œ ì‹œê°„ë§Œí¼ ìºì‹œë¡œ í™˜ë¶ˆë©ë‹ˆë‹¤.</li>
                        </ul>
                        <h3>ì†Œì…œë§¤ì¹˜ ì·¨ì†Œ ë°©ë²•</h3>
                        <ul>
                            <li>ë§ˆì´í˜ì´ì§€ â†’ ì‹ ì²­ ë‚´ì—­ â†’ ì†Œì…œ ë§¤ì¹˜ íƒ­ í´ë¦­ â†’ ì·¨ì†Œë¥¼ ì›í•˜ëŠ” ë§¤ì¹˜ì˜ ì‹ ì²­ë‚´ì—­ í´ë¦­ í›„ ì·¨ì†Œ</li>
                            <a href="/cart" style="color: black;">ì‹ ì²­ ë‚´ì—­ ë°”ë¡œ ê°€ê¸°</a>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="match-details">
                <span th:if="${item.itemSellStatus == T(com.example.foot.constant.ItemSellStatus).SELL}"
                      class="badge bg-primary mgb-15 " style="background-color:#0054FF !important;">ì‹ ì²­ê°€ëŠ¥</span>
                <span th:unless="${item.itemSellStatus == T(com.example.foot.constant.ItemSellStatus).SELL}"
                      class="badge bg-primary mgb-15" style="background-color:#FF0000 !important;">ì‹ ì²­ë§ˆê°</span>
                <div class="DateInfo" style="display:flex;">
                    <div class="h3" th:text="${item.formattedPlayDateWithDayOfWeek}"></div>
                    <div class="h3" th:text="${item.playTime}"></div>
                </div>
                <div class="h4" th:text="${item.itemNm}"></div>
                <div class="ad" style="display:flex;">
                    <div class="h7" th:text="${item.playAddress}" style="margin-right:10px;"></div>
                    <div class="map">
                        <!-- ì£¼ì†Œ ë³µì‚¬ ë²„íŠ¼ -->
                        <a href="#" id="copyAddress" onclick="copyAddressFunction()">ì£¼ì†Œ ë³µì‚¬</a>
                        <!-- ì§€ë„ ë³´ê¸° ë²„íŠ¼ -->
                        <a href="#" id="showMap" onclick="showMapFunction()">ì§€ë„ ë³´ê¸°</a>
                        <script>


                            // ì§€ë„ ë³´ê¸° ê¸°ëŠ¥
                            function showMapFunction() {
                                const mapDiv = document.getElementById("map");

                                if (mapDiv.style.display === "none") {
                                    mapDiv.style.display = "block";
                                    initMap();  // ì§€ë„ë¥¼ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
                                } else {
                                    mapDiv.style.display = "none";
                                }
                            }

                            function initMap() {
                                const mapContainer = document.getElementById('map');
                                const geocoder = new kakao.maps.services.Geocoder();

                                // ì‚¬ìš©ìë¡œë¶€í„° ì…ë ¥ë°›ì€ ì£¼ì†Œë¥¼ ì‚¬ìš©
                                const address = '[[${item.playAddress}]]';  // ì—¬ê¸°ì— ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì£¼ì†Œë¥¼ ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.

                                geocoder.addressSearch(address, function (result, status) {
                                    if (status === kakao.maps.services.Status.OK) {
                                        const coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                                        // ì§€ë„ë¥¼ ì…ë ¥ëœ ì£¼ì†Œë¡œ ì´ˆê¸°í™”
                                        const mapOption = {
                                            center: coords,  // ê²€ìƒ‰ëœ ì¢Œí‘œë¥¼ ì§€ë„ì˜ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ì •
                                            level: 3  // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
                                        };

                                        const map = new kakao.maps.Map(mapContainer, mapOption);

                                        // ë§ˆì»¤ë¥¼ ìƒì„±í•˜ê³  ì§€ë„ì— í‘œì‹œ
                                        const marker = new kakao.maps.Marker({
                                            map: map,
                                            position: coords
                                        });
                                    } else {
                                        alert('ì£¼ì†Œ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                                    }
                                });
                            }
                        </script>
                        <script type="text/javascript"
                                src="//dapi.kakao.com/v2/maps/sdk.js?appkey=07b9ad12a78d58166bb7390410fdfacc&libraries=services">
                        </script>
                    </div>
                </div>
                <div id="map" style="width:100%;height:350px;display:none;"></div>
                <hr class="my-4">
                <div class="text-right">
                    <div class="h4 text-danger text-left" style="color:black !important;">
                        <input type="hidden" th:value="${item.price}" id="price" name="price">
                        <span th:text="${item.price}"></span>ì›/2ì‹œê°„
                    </div>
                    <div class="input-group w-50">
                        <div class="input-group-prepend">
                            <span class="input-group-text">ìˆ˜ëŸ‰</span>
                        </div>
                        <input type="number" name="count" id="count" class="form-control" value="1" max="1" min="0">
                    </div>
                    <hr class="my-4">
                    <div th:if="${item.itemSellStatus == T(com.example.foot.constant.ItemSellStatus).SELL}"
                         class="text-right">
                        <button type="button" class="btn btn-light border custom-btn" onclick="addCart()">
                            <img src="/img/soccer (2).png" alt="ì°œ,ì¥ë°”êµ¬ë‹ˆ">
                        </button>
                        <button type="button" class="btn btn-primary btn-lg" onclick="order()">ì‹ ì²­í•˜ê¸°</button>
                    </div>
                    <div th:unless="${item.itemSellStatus == T(com.example.foot.constant.ItemSellStatus).SELL}"
                         class="text-right">
                        <button type="button" class="btn btn-danger btn-lg">í’ˆì ˆ</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- ëŒ“ê¸€ ì‘ì„± ë¶€ë¶„ -->
        <div class="last">
            <h1>ë§¤ì¹˜ í›„ê¸°</h1>
            <div sec:authorize="isAuthenticated()" id="comment-write" class="comment-section">
                <div class="comment-write">
                    <p id="commentWriter" th:text="${email}">example@example.com</p>
                    <textarea id="commentContents" placeholder="ë‚´ìš©"></textarea>
                    <button id="comment-write-btn" onclick="commentWrite()">ì‘ì„±</button>
                </div>
            </div>
            <!-- ëŒ“ê¸€ ì¶œë ¥ ë¶€ë¶„ -->
            <div id="comment-list" class="comment-section">
                <table>
                    <tr>
                        <th style="width:100px">ì‘ì„±ì</th>
                        <th style="width:730px">ë‚´ìš©</th>
                        <th style="width:150px">ì‘ì„±ì‹œê°„</th>
                    </tr>
                    <tr th:each="comment: ${commentList}">
                        <td class="fixed-writer">
                            <span id="commentsWriter" th:text="${comment.commentWriter}">ì‘ì„±ìëª…</span>
                        </td>
                        <td class="fixed-contents">
                            <span id="commentContents-${comment.id}" th:text="${comment.commentContents}">ëŒ“ê¸€ ë‚´ìš©</span>
                        </td>
                        <td class="fixed-dateWidth">
                            <span
                                    th:text="${#temporals.format(comment.commentCreatedTime, 'yyyy-MM-dd HH:mm:ss')}">2024-08-22
                                16:00:00
                            </span>
                        </td>
                        <td class="comment-delete">
                            <button sec:authorize="isAuthenticated()" class="btn-comment-delete"
                                    th:data-comment-id="${comment.id}" th:data-comment-writer="${comment.commentWriter}">ì‚­ì œ
                            </button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
<script>
    // ì£¼ì†Œ ë³µì‚¬ ê¸°ëŠ¥
    function copyAddressFunction() {
    // ì˜ˆì‹œ ì£¼ì†Œ
    var address = '[[${item.playAddress}]]';

    // í´ë¦½ë³´ë“œì— ì£¼ì†Œ ë³µì‚¬
    navigator.clipboard.writeText(address).then(function () {
    alert("ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤: " + address);
    }, function (err) {
    alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. " + err);
    });
    }
</script>
</body>
</html>

<script>
    const commentWrite = () => {
        const writer = document.getElementById("commentWriter").innerText; // ì‘ì„±ì ì´ë¦„ì„ ê°€ì ¸ì˜´
        const contents = document.getElementById("commentContents").value;

        // ë‚´ìš©ì´ ì—†ì„ ë•Œ ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ
        if (!contents) {
            alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return; // ë‚´ìš©ì´ ì—†ìœ¼ë©´ í•¨ìˆ˜ ì¢…ë£Œ
        }

        if (contents.length > 255) {
            alert("ë‚´ìš©ì€ 255ìê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤");
            return;
        }

        console.log("ì‘ì„±ì : ", writer);
        console.log("ë‚´ìš© : ", contents);

        const id = document.getElementById("itemId").value; // ê²Œì‹œê¸€ ë²ˆí˜¸
        console.log("ê²Œì‹œê¸€ ë²ˆí˜¸ : ", id);

        // CSRF í† í°ê³¼ í—¤ë” ê°€ì ¸ì˜¤ê¸°
        const token = document.querySelector('meta[name="_csrf"]').getAttribute('content');
        const header = document.querySelector('meta[name="_csrf_header"]').getAttribute('content');

        $.ajax({
            type: "POST",
            url: "/comment/save",
            data: {
                "commentWriter": writer,
                "commentContents": contents,
                "itemId": id
            },
            beforeSend: function (xhr) {
                // ë°ì´í„° ì „ì†¡í•˜ê¸° ì „ì— í—¤ë”ì— CSRF í† í° ì„¤ì •
                xhr.setRequestHeader(header, token);
            },
            success: function (res) {
                console.log("ìš”ì²­ ì„±ê³µ", res);
                let output = "<table>";
                output += "<tr>";
                output += "<th>ì‘ì„±ì</th>";
                output += "<th>ë‚´ìš©</th>";
                output += "<th>ì‘ì„±ì‹œê°„</th>"
                for (let i in res) {
                    // ë‚ ì§œ í˜•ì‹ ë³€í™˜
                    let date = new Date(res[i].commentCreatedTime);
                    let formattedDate = date.getFullYear() + '-' +
                        ('0' + (date.getMonth() + 1)).slice(-2) + '-' +
                        ('0' + date.getDate()).slice(-2) + ' ' +
                        ('0' + date.getHours()).slice(-2) + ':' +
                        ('0' + date.getMinutes()).slice(-2) + ':' +
                        ('0' + date.getSeconds()).slice(-2);

                    output += "<tr>";
                    output += "<td class='fixed-writer'>" + res[i].commentWriter + "</td>";
                    output += "<td class='fixed-contents'>" + res[i].commentContents + "</td>";
                    output += "<td class='fixed-dateWidth'>" + formattedDate + "</td>"; // ë³€í™˜ëœ ë‚ ì§œ ì‚¬ìš©
                    output += "<td class='comment-delete'><button sec:authorize='isAuthenticated()' class='btn-comment-delete' data-comment-id='" + res[i].id + "' data-comment-writer='" + res[i].commentWriter + "'>ì‚­ì œ</button></td>";
                    output += "</tr>";
                }
                output += "</table>";
                document.getElementById('comment-list').innerHTML = output;
                document.getElementById('commentWriter').value = '';
                document.getElementById('commentContents').value = '';

                // ìƒˆë¡œ ì¶”ê°€ëœ ì‚­ì œ ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                addDeleteButtonEventListeners();
            },
            error: function (err) {
                console.log("ìš”ì²­ ì‹¤íŒ¨", err);
            }
        });
    };

    const addDeleteButtonEventListeners = () => {
        var commentDeleteButtons = document.querySelectorAll(".btn-comment-delete");
        const writer = document.getElementById("commentWriter").innerText;

        commentDeleteButtons.forEach(function (button) {
            button.addEventListener("click", function () {
                var commentId = button.getAttribute("data-comment-id");
                var commentWriter = button.getAttribute("data-comment-writer");
                console.log(writer);
                console.log(commentWriter);

                if (confirm("ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                    // CSRF í† í° ê°€ì ¸ì˜¤ê¸°
                    var csrfToken = document.querySelector("meta[name='_csrf']").getAttribute("content");
                    var csrfHeader = document.querySelector("meta[name='_csrf_header']").getAttribute("content");

                    if (writer != commentWriter) {
                        alert("ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.")
                        return;
                    }
                    $.ajax({
                        type: "DELETE",
                        url: "/comment/delete/" + commentId,
                        beforeSend: function (xhr) {
                            // CSRF í† í°ê³¼ í—¤ë” ì„¤ì •
                            xhr.setRequestHeader(csrfHeader, csrfToken);
                        },
                        success: function () {
                            alert("ì‚­ì œí–ˆìŠµë‹ˆë‹¤!!");
                            window.location.href = "/item/" + document.getElementById("itemId").value;
                        },
                        error: function (xhr, status, error) {
                            console.error('ëŒ“ê¸€ ì‚­ì œ ì‹¤íŒ¨: ' + error);
                            alert('ëŒ“ê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    });
                }
            });
        });
    };
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    document.addEventListener("DOMContentLoaded", addDeleteButtonEventListeners);
</script>
<script>
    function toggleContent1() {
        var content = document.getElementById('arrow-content1');
        var arrow = document.querySelector('.arrow1');

        if (content.style.height === '0px' || content.style.height === '') {
            content.style.height = content.scrollHeight + 'px';
            arrow.classList.add('rotate');
        } else {
            content.style.height = '0px';
            arrow.classList.remove('rotate');
        }
    }
    function toggleContent2() {
        var content = document.getElementById('arrow-content2');
        var arrow = document.querySelector('.arrow2');

        if (content.style.height === '0px' || content.style.height === '') {
            content.style.height = content.scrollHeight + 'px';
            arrow.classList.add('rotate');
        } else {
            content.style.height = '0px';
            arrow.classList.remove('rotate');
        }
    }
</script>
