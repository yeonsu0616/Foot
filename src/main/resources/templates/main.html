<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">
<!-- 사용자 CSS 추가 -->
<th:block layout:fragment="css">
    <style>
       .carousel-inner > .carousel-item {
           height : 430px;
           position: relative;
       }
         .carousel-item img, .carousel-item svg{
          width: 100%;
          height: 100%;
          border-radius: 20px;
       }
       .carousel-indicators [data-bs-target] {
       background-color: #ffdc86; /* 원하는 색상 코드로 변경 */
       }
       .carousel-indicators .active {
        background-color: #ffdc86; /* 원하는 색상 코드로 변경 */
       }
       .margin{
           margin-bottom : 30px;
       }
       .banner{
           height : 300px;
           position :  absolute; top:0; left:0;
           width: 100%;
           height: 100%;
       }
       .card {
          border-radius: 10px;
          transition: transform 0.2s, box-shadow 0.2s;
        }

        .card:hover {
          transform: scale(1.05);
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .card-img-top {
          border-top-left-radius: 10px;
          border-top-right-radius: 10px;
        }
       a:hover{
           text-decoration:none;
       }
       .center{
           text-align:center;
       }

       .search-bar button {
           border: none;
           background: none;
           position: absolute;
           right: 1px;
           top: 50%;
           transform: translateY(-50%);
       }
       .carousel-control-prev,
       .carousel-control-next{
            width:5%;
       }
       .carousel-control-prev-icon,
       .carousel-control-next-icon {
           background-color: orange; /* 화살표 색상 */
           height: 40px; /* 화살표 높이 */
           width: 40px; /* 화살표 너비 */
           border-radius: 50%; /* 화살표 모양을 원형으로 */
           border: 1px solid orange; /* 테두리 */
       }
       carousel-caption.{
        width:100%;
       }
       .category-main-text,
       .category-sub-text{
           margin-left: 100px;
           margin-top: 30px;
       }
       a.more-view {
       display: block;
       width: 180px;
       height: 55px;
       margin: 40px auto 15px auto;
       border-radius: 25px;
       border: solid 4px #e7e7e7;
       padding: 12px 56.7px 14px 53px;
       cursor: pointer;
       text-decoration: none;
}
       .more {
       float: center;
       font-size: 18px;
       margin-left: 6px;
       color: black;
       margin-bottom:10px;
}
       a.more-view-arrow {
       object-fit: contain;
       width: 13.3px;
       height: 13.6px;
       margin: 5px 0px 3px 10px;
       background: url(/img/button/화살표.png) no-repeat;
       background-position: center;
       background-size: cover;
       float: left;
   }
   .swiper-container {
           display: flex;
           justify-content: center; /* 컨테이너를 왼쪽으로 정렬 */
           align-items: flex-start; /* 항목들을 위쪽으로 정렬 */
       }
        .prd-item-list {
        display: flex;
         justify-content: space-between;
        list-style-type: none;
        padding: 0;
        margin: 0;
}

   .prd-item {
       text-align: center;
       margin: 10px;
       flex: 1; /* 각 항목이 동일한 너비를 가지도록 설정 */
       max-width: 300px; /* 각 항목의 최대 너비 설정 */
       margin-bottom: 20px;
   }
   .prd-item img{
       width:280px;
       height:auto;
       cursor: pointer;
       transition: transform 0.3s ease;
       border-radius: 20px;
   }
    .prd-item img:hover {
           transform: scale(0.9); /* 이미지를 90%로 축소 */
           border-radius: 20px;
           border:5px solid orange;
       }

   #display-image img{
   width:200px;
   height: auto;
   margin-top:50px;
   }
   #display-container{
       display: flex;
       align-items: flex-start;
       margin-top: 20px;
       margin-left:280px;

   }
   #description{
       max-width: 800px;
       margin-left:60px;
       font-size:1.8rem;
        font-weight: bold;
           color: #333;
           display: block;
           margin-bottom: 10px;
       padding: 20px;
           background-color: #ffffff; /* White background */
           border-radius: 15px;
           box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
           text-align: center;
           color: #333; /* Dark text color */
           border: 2px solid #ff8c00; /* Dark orange border */
            }
   .img img {
   display: block;
   margin: 0 auto;
   max-width: 100%;
   height: auto;
   }
   .desc-bottom {
       margin-top: 10px;
   }
   .tit a{
       display: block;
       font-size: 1.8rem;
       color:black;
   }

   .new-mealkit-slide .img3 {
   width: 90px;
   height: 90px;
   background: url(/img/New.png) no-repeat;
   position: absolute;
   top: 2050px;
   left: 280px;
   z-index: 3;
   background-size: cover;
}
        a{
        text-decoration:none;
        }
        .icons {
    display: flex;
    justify-content: space-around;
    padding: 20px;
    max-width: 1500px;
    margin: 0px auto;
}
        .icon-item {
    text-align: center;
}

.icon-item img {
    width: 50px;
    margin-bottom: 5px;
}

.icon-item p {
    margin: 0;
    font-weight: bold;
    color: #333;
}
       .img img {
   display: block;
   margin: 0 auto;
   max-width: 100%;
   height: auto;
   }
        /*달력*/
        .calendar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0px auto;
            max-width:1200px;
        }

        .days-container {
            display: flex;
            flex: 1;
            justify-content: space-around;
        }

        .day {
            text-align: center;
            flex: 1;
            cursor: pointer;
            padding: 10px;
        }

        .day:hover {
            background-color: #f0f0f0;
        }

        .date {
            display: block;
            font-size: 20px;
            margin-bottom: 5px;
        }

        .active1 {
            background-color: #007bff;
            color: white;
            padding: 10px;
            border-radius: 20px;
        }

        .label {
            color: #666;
        }

        .sunday {
            color: red;
        }

        .saturday {
            color: blue;
        }

        .arrow {
            cursor: pointer;
            font-size: 20px;
            user-select: none;
            margin-left: 50px;
        }

        .disabled {
            color: #ccc;
            cursor: not-allowed;
        }

    </style>

    <script>
        function showImage(src, result) {
            document.getElementById("display-image").src = src;
            document.getElementById("description").innerHTML = result;
        }
        document.addEventListener("DOMContentLoaded", function() {
            var items = document.querySelectorAll(".prd-item");
            items.forEach(function(item) {
                item.addEventListener("click", function() {
                    var img = this.querySelector("img").src;
                    var desc = this.querySelector(".tit a").innerHTML;
                    console.log(desc);
                    var price = this.querySelector(".tit #price").value;
                    console.log(price);
                    var result = "<div><div>"+desc+"</div><hr><div>"+price+"원"+"</div></div>"

                    //desc += this.querySelector(".tit #price)
                    showImage(img, result);
                });
            });
        });

    </script>
</th:block>
<body>
<div layout:fragment="content">
    <section class="icons">
        <div class="icon-item">
            <img src="/img/bird.png" alt="알리버드 Icon"> <!-- Replace with your 알리버드 icon -->
            <p>얼리버드</p>
        </div>
        <div class="icon-item">
            <img src="/img/team.png" alt="친구 매치 Icon"> <!-- Replace with your 친구 매치 icon -->
            <p>세미 프로</p>
        </div>
        <div class="icon-item">
            <img src="/img/ball.png" alt="축구 매치 Icon"> <!-- Replace with your 축구 매치 icon -->
            <p>축구 매치</p>
        </div>
        <div class="icon-item">
            <img src="/img/leaf.png" alt="비기너 Icon"> <!-- Replace with your 비기너 icon -->
            <p>비기너</p>
        </div>
        <div class="icon-item">
            <a href="https://www.instagram.com/plabfootball/">
            <img src="/img/instagram.jpg" alt="팀 리그 Icon"> <!-- Replace with your 팀 리그 icon -->
            <p>인스타그램</p>
            </a>
        </div>
    </section>
    <div id="main-content" style="display: none;"></div>
    <!-- 슬라이드 -->
    <div id="myCarousel" class="carousel slide mb-6" data-bs-ride="carousel" style="padding: 0 250px 0 250px;">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="3" aria-label="Slide 4"></button>
            <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="4" aria-label="Slide 5"></button>
        </div>
        <div class="carousel-inner" >
            <div class="carousel-item active">
                <a href="/members/invite">
                    <svg class="bd-placeholder-img" width="1024px"  xmlns="http://www.w3.org/2000/svg" aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="17936px" height="120%" fill="#f2f5f7"/>
                    </svg>
                    <div class="container">
                        <div class="carousel-caption">
                            <img src="/img/1.jpg" class="img-fluid" alt="친구 초대">
                        </div>
                    </div>
                </a>
            </div>
            <div class="carousel-item">
                <a href="/members/culture">
                    <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#f2f5f7"/></svg>
                    <div class="container">
                        <div class="carousel-caption">
                            <img src="/img/2.png" class="img-fluid" alt="존중">
                        </div>
                    </div>
                </a>
            </div>
            <div class="carousel-item">
                <a href="/members/team">
                    <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#f2f5f7"/></svg>
                    <div class="container">
                        <div class="carousel-caption">
                            <img src="/img/3.png" class="img-fluid" alt="팀으로 즐겨요">

                        </div>
                    </div>
                </a>
            </div>
            <div class="carousel-item">
                <a href="http://localhost/item/10">
                    <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#f2f5f7"/></svg>
                    <div class="container">
                        <div class="carousel-caption">
                            <img src="/img/4.png" class="img-fluid" alt="내 주변의 팀">

                        </div>
                    </div>
                </a>
            </div>
            <div class="carousel-item">
                <a href="/members/team1">
                    <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                        <rect width="100%" height="100%" fill="#f2f5f7"/></svg>
                    <div class="container">
                        <div class="carousel-caption">
                            <img src="/img/6.png" class="img-fluid" alt="스토리">
                        </div>
                    </div>
                </a>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

<!--달력-->
    <div class="calendar">
        <div id="prev-arrow" class="arrow" onclick="prevWeek()">
            <img src="/img/back.png" width="30%">
        </div>
        <div id="days-container" class="days-container"></div>
        <div id="next-arrow" class="arrow" onclick="nextWeek()">
            <img src="/img/forward.png" width="30%">
        </div>
    </div>
    <script>
        const daysContainer = document.getElementById('days-container');
        const prevArrow = document.getElementById('prev-arrow');
        let currentDay = new Date();
        const today = new Date();
        let selectedDate = today; // 기본값은 오늘 날짜

        function formatDay(date) {
            const options = { weekday: 'short' };
            return date.toLocaleDateString('ko-KR', options);
        }

        function createDayElement(date, isActive) {
            const dayDiv = document.createElement('div');
            dayDiv.className = 'day';

            const dateSpan = document.createElement('span');
            dateSpan.className = 'date';
            if (isActive) {
                dateSpan.classList.add('active1');
            }
            dateSpan.textContent = date.getDate();

            const labelSpan = document.createElement('span');
            labelSpan.className = 'label';
            const dayOfWeek = formatDay(date);
            labelSpan.textContent = dayOfWeek;

            if (dayOfWeek === '일') {
                labelSpan.classList.add('sunday');
            } else if (dayOfWeek === '토') {
                labelSpan.classList.add('saturday');
            }

            dayDiv.appendChild(dateSpan);
            dayDiv.appendChild(labelSpan);

            // 날짜 클릭 이벤트 추가
            dayDiv.onclick = () => {
                selectedDate = date; // 클릭한 날짜 저장
                renderCalendar(currentDay); // 다시 렌더링하여 선택된 날짜 표시
                fetchItemsByDate(date); //해당 날짜의 상품을 가져와 표시
            };

            return dayDiv;
        }

        function renderCalendar(startDate) {
            daysContainer.innerHTML = '';

            for (let i = 0; i < 7; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                const isActive = date.toDateString() === selectedDate.toDateString();
                const dayElement = createDayElement(date, isActive);
                daysContainer.appendChild(dayElement);
            }

            // 이전 날짜로 못 가도록 제어
            if (startDate <= today) {
                prevArrow.classList.add('disabled');
                prevArrow.onclick = null;
            } else {
                prevArrow.classList.remove('disabled');
                prevArrow.onclick = prevWeek;
            }
        }

        function prevWeek() {
            const newDate = new Date(currentDay);
            newDate.setDate(currentDay.getDate() - 7);

            // 오늘 날짜 이전으로 가지 않도록 제어
            if (newDate < today) {
                return;
            }

            currentDay = newDate;
            renderCalendar(currentDay);
        }

        function nextWeek() {
            currentDay.setDate(currentDay.getDate() + 7);
            renderCalendar(currentDay);
        }

        // 처음 렌더링
        renderCalendar(currentDay);

        //추가
        function fetchItemsByDate(date) {
        const formattedDate = date.toISOString().split('T')[0]; // 'YYYY-MM-DD' 형식으로 날짜를 변환


    $.ajax({
        url: '/getItemsByDate',
        type: 'GET',
        data: { playDate: formattedDate },
        success: function(items) {
            updateItems(items);
        },
        error: function(error) {
            console.error('Error fetching items:', error);
        }
    });
}

function updateItems(items) {
    const container = document.getElementById('time-item-container');
    container.innerHTML = ''; // 기존 항목 제거

    items.forEach(item => {
        const itemHtml = `
            <div class="col-12 mb-2" style="width: 80%; display: inline-block;">
                <div class="d-flex justify-content-between align-items-center border-bottom p-2">
                    <a href="/item/${item.id}" class="text-dark" style="display:flex; padding: 20px 15px;">
                        <!--시간-->
                        <div class="text-nowrap" style="width: 60px;">
                            <strong>${item.formattedPlayTime}</strong>
                        </div>
                        <!-- 장소 및 기타 정보 -->
                        <div class="flex-grow-1 ms-3">
                            <div>
                                <span>${item.itemNm}</span>
                            </div>
                            <div class="text-muted" style="text-align:start;">
                                <small>${item.matchInfo}</small>
                                <small>${item.level}</small>
                                <small>${item.gender}</small>
                            </div>
                        </div>
                        <!-- 상태-->
                        <div class="text-end" style="width:100px;">
                            <span class="badge bg-primary mgb-15" style="background-color:${item.itemSellStatus === 'SELL' ? '#0054FF' : '#FF0000'} !important;">
                                ${item.itemSellStatus === 'SELL' ? '신청가능' : '신청마감'}
                            </span>
                        </div>
                    </a>
                </div>
            </div>
        `;
        container.insertAdjacentHTML('beforeend', itemHtml);
    });
}
    </script>
    <!---->
    <!-- 추천 랜덤 밀키트 -->
    <div class="container text-center" style="font-size: larger; margin-top:50px;">
        <div id="time-item-container" class="row row-cols-5" style="display: contents;">
            <th:block th:each="item: ${TimeItem}">
                <div class="col-12 mb-2" style="width: 80%; display: inline-block;">
                    <div class="d-flex justify-content-between align-items-center border-bottom p-2">
                        <a th:href="'/item/' + ${item.id}" class="text-dark" style="display:flex; padding: 20px 15px;">
                            <!--시간-->
                            <div class="text-nowrap" style="width: 60px;">
                                <strong th:text="${item.formattedPlayTime}">[[${item.formattedPlayTime}]]</strong>
                            </div>
                            <!-- 장소 및 기타 정보 -->
                            <div class="flex-grow-1 ms-3">
                                <div>
                                    <span th:text="${item.itemNm}"></span>
                                </div>
                                <div class="text-muted" style="text-align:start;">
                                    <small th:text="${item.matchInfo}"></small>
                                    <small th:text="${item.level}"></small>
                                   <small th:text="${item.gender}"></small>
                                </div>
                            </div>
                            <!-- 상태-->
                            <div class="text-end" style="width:100px;">
                            <span th:if="${item.itemSellStatus == T(com.example.foot.constant.ItemSellStatus).SELL}"
                                  class="badge bg-primary mgb-15" style="background-color:#0054FF !important;">신청가능</span>
                                <span th:unless="${item.itemSellStatus == T(com.example.foot.constant.ItemSellStatus).SELL}"
                                      class="badge bg-primary mgb-15" style="background-color:#FF0000 !important;">신청마감</span>
                            </div>
                        </a>
                    </div>
                </div>
            </th:block>
        </div>
    </div>
    <br>
    <!-- 더보기 -->
    <a href="/itemRec" class="more-view">
        <p class="more">더보기</p>
        <div class="more-view-arrow"></div>
    </a>
    <br>
<!--    <div class="swiper main-category-btn-wrapper swipe-disabled">-->
<!--        <h2 class="category-main-text"> 이주의 <span style="color:#ff6b00;">신상</span> 밀키트예요.</h2>-->
<!--        <p class="category-sub-text">주목 할 만한 신제품을 소개해요.</p>-->
<!--        <p class="h3 font-weight-bold" style="margin-left:850px" th:text="${itemSearchDto.searchQuery}"></p>-->
<!--    </div>-->
    <!-- 신상 밀키트 -->

</div>
<br>
<div th:replace="footer :: footer"></div>
<script src="script.js"></script>
</body>
</html>
